import{_ as X}from"./_plugin-vue_export-helper-DRcqrMy4.js";import{v as ee}from"./el-loading-CZvZ1YE_.js";import{E as te}from"./el-card-Dguapzm2.js";import{E as oe}from"./el-dialog-pCIKPT3_.js";import"./el-overlay-Czg3P4MJ.js";import{a as le,E as ne}from"./el-form-item-BAbr5JjY.js";/* empty css                 */import{E as ae}from"./el-input-number-G37_5v12.js";import{E as re}from"./el-empty-DZ3VuUlJ.js";import{E as ie,a as se}from"./el-table-column-DqRgEsS6.js";import"./el-checkbox-pWPRGKSY.js";import"./el-tooltip-l0sNRNKZ.js";import{b as W,u as O,a as pe}from"./el-popper-CPlk0iR1.js";import"./el-scrollbar-BAAyYTJs.js";/* empty css                  *//* empty css               */import{y as ue,bH as de,K as ce,bI as j,_ as me,A as fe,aA as ve,B as ge,r as y,p as C,G as p,aZ as ye,O as E,o as d,w as a,F as H,g as L,f as r,H as B,k as i,m as _e,N as be,P as we,t as c,h as o,j as M,aR as Ce,T as Ee,c as Te,q as ke,s as Be,Y as Re,U as K,e as S,V as Ve,W as he,E as Pe,l as D}from"./index-Dczg_W-s.js";import{e as Fe,u as Ie,f as Ne}from"./admin-gqFvFKRd.js";import"./index-D5yFMpEK.js";import"./refs-D6FW0B1r.js";import"./castArray-Bkbd9iUu.js";import"./_baseClone-DlauArLD.js";import"./omit-CXgNd_Yj.js";import"./_baseIteratee-YKiEvp97.js";import"./debounce-D6x4jhS0.js";import"./toNumber-BxgSLSKp.js";import"./raf-BqDiCstf.js";const Ue=ue({title:String,confirmButtonText:String,cancelButtonText:String,confirmButtonType:{type:String,values:j,default:"primary"},cancelButtonType:{type:String,values:j,default:"text"},icon:{type:ce,default:()=>de},iconColor:{type:String,default:"#f90"},hideIcon:Boolean,hideAfter:{type:Number,default:200},effect:{...O.effect,default:"light"},teleported:O.teleported,persistent:O.persistent,width:{type:[String,Number],default:150},virtualTriggering:W.virtualTriggering,virtualRef:W.virtualRef}),xe={confirm:_=>_ instanceof MouseEvent,cancel:_=>_ instanceof MouseEvent},$e=fe({name:"ElPopconfirm",__name:"popconfirm",props:Ue,emits:xe,setup(_,{expose:R,emit:b}){const m=_,f=b,{t:u}=ve(),s=ge("popconfirm"),l=y(),V=y(),N=C(()=>{var t;return(t=p(l))==null?void 0:t.popperRef}),h=()=>{var t,e;(e=(t=V.value)==null?void 0:t.focus)==null||e.call(t)},v=()=>{var t,e;(e=(t=l.value)==null?void 0:t.onClose)==null||e.call(t)},P=C(()=>({width:ye(m.width)})),F=t=>{f("confirm",t),v()},T=t=>{f("cancel",t),v()},U=C(()=>m.confirmButtonText||u("el.popconfirm.confirmButtonText")),I=C(()=>m.cancelButtonText||u("el.popconfirm.cancelButtonText"));return R({popperRef:N,hide:v}),(t,e)=>(d(),E(p(pe),Ce({ref_key:"tooltipRef",ref:l,trigger:"click",effect:t.effect},t.$attrs,{"virtual-triggering":t.virtualTriggering,"virtual-ref":t.virtualRef,"popper-class":`${p(s).namespace.value}-popover`,"popper-style":P.value,teleported:t.teleported,"fallback-placements":["bottom","top","right","left"],"hide-after":t.hideAfter,persistent:t.persistent,loop:"",onShow:h}),{content:a(()=>[r("div",{ref_key:"rootRef",ref:V,tabindex:"-1",class:B(p(s).b())},[r("div",{class:B(p(s).e("main"))},[!t.hideIcon&&t.icon?(d(),E(p(_e),{key:0,class:B(p(s).e("icon")),style:be({color:t.iconColor})},{default:a(()=>[(d(),E(we(t.icon)))]),_:1},8,["class","style"])):L("v-if",!0),i(" "+c(t.title),1)],2),r("div",{class:B(p(s).e("action"))},[H(t.$slots,"actions",{confirm:F,cancel:T},()=>[o(p(M),{size:"small",type:t.cancelButtonType==="text"?"":t.cancelButtonType,text:t.cancelButtonType==="text",onClick:T},{default:a(()=>[i(c(I.value),1)]),_:1},8,["type","text"]),o(p(M),{size:"small",type:t.confirmButtonType==="text"?"":t.confirmButtonType,text:t.confirmButtonType==="text",onClick:F},{default:a(()=>[i(c(U.value),1)]),_:1},8,["type","text"])])],2)],2)]),default:a(()=>[t.$slots.reference?H(t.$slots,"reference",{key:0}):L("v-if",!0)]),_:3},16,["effect","virtual-triggering","virtual-ref","popper-class","popper-style","teleported","hide-after","persistent"]))}});var Oe=me($e,[["__file","/home/runner/work/element-plus/element-plus/packages/components/popconfirm/src/popconfirm.vue"]]);const Se=Ee(Oe),De={class:"flex-between mb-20"},Le={key:1,class:"mobile-card-list"},Me={class:"card-header flex-between"},ze={class:"cat-name"},qe={class:"cat-id text-gray"},Ae={class:"card-body"},We={class:"info-row"},je={class:"value"},He={class:"info-row"},Ke={class:"value"},Ge={class:"info-row"},Ye={class:"value"},Ze={class:"card-footer"},Je=768,Qe={__name:"CategoryManage",setup(_){const R=y(window.innerWidth),b=C(()=>R.value<Je),m=y(!1),f=y([]),u=y(!1),s=y(null),l=Te({id:null,catName:"",minPrice:0,platformFeeRatio:.1,sortOrder:10,catIconUrl:""}),V={catName:[{required:!0,message:"请输入类目名称",trigger:"blur"}],minPrice:[{required:!0,message:"请输入起步价",trigger:"blur"}],platformFeeRatio:[{required:!0,message:"请输入抽成比例",trigger:"blur"}]},N=C(()=>l.id?"编辑类目":"新增类目");ke(()=>{v(),window.addEventListener("resize",h)}),Be(()=>{window.removeEventListener("resize",h)});const h=()=>{R.value=window.innerWidth};async function v(){m.value=!0;try{f.value=await Re()}finally{m.value=!1}}function P(){var t;l.id=null,l.catName="",l.minPrice=0,l.platformFeeRatio=.1,l.sortOrder=10,l.catIconUrl="",(t=s.value)==null||t.resetFields()}function F(){P(),u.value=!0}function T(t){Object.assign(l,t),u.value=!0}async function U(){s.value&&await s.value.validate(async t=>{if(t)try{l.id?(await Ie(l),D.success("更新成功")):(await Ne(l),D.success("新增成功")),u.value=!1,v()}catch(e){console.error("表单提交失败",e)}})}async function I(t){await Fe(t.id),D.success("删除成功"),v()}return(t,e)=>{const g=M,w=se,z=Se,G=ie,Y=re,q=Pe,k=ne,x=ae,Z=le,J=oe,Q=te,A=ee;return d(),E(Q,null,{default:a(()=>[r("div",De,[e[8]||(e[8]=r("h3",null,"服务类目管理",-1)),o(g,{type:"primary",icon:"Plus",onClick:F},{default:a(()=>[...e[7]||(e[7]=[i("新增类目",-1)])]),_:1})]),b.value?K((d(),S("div",Le,[f.value.length===0?(d(),E(Y,{key:0,description:"暂无服务类目"})):L("",!0),(d(!0),S(Ve,null,he(f.value,n=>(d(),S("div",{key:n.id,class:"cat-card"},[r("div",Me,[r("span",ze,c(n.catName),1),r("span",qe,"ID: "+c(n.id),1)]),r("div",Ae,[r("div",We,[e[11]||(e[11]=r("span",{class:"label"},"起步价:",-1)),r("span",je,"¥ "+c(n.minPrice.toFixed(2)),1)]),r("div",He,[e[12]||(e[12]=r("span",{class:"label"},"抽成:",-1)),r("span",Ke,c((n.platformFeeRatio*100).toFixed(0))+"%",1)]),r("div",Ge,[e[13]||(e[13]=r("span",{class:"label"},"排序:",-1)),r("span",Ye,c(n.sortOrder),1)])]),r("div",Ze,[o(g,{link:"",type:"primary",icon:"Edit",onClick:$=>T(n)},{default:a(()=>[...e[14]||(e[14]=[i("编辑",-1)])]),_:1},8,["onClick"]),o(z,{title:"确定要删除吗？",onConfirm:$=>I(n)},{reference:a(()=>[o(g,{link:"",type:"danger",icon:"Delete"},{default:a(()=>[...e[15]||(e[15]=[i("删除",-1)])]),_:1})]),_:1},8,["onConfirm"])])]))),128))])),[[A,m.value]]):K((d(),E(G,{key:0,data:f.value,border:"",stripe:""},{default:a(()=>[o(w,{prop:"id",label:"ID",width:"80"}),o(w,{prop:"catName",label:"名称"}),o(w,{prop:"minPrice",label:"起步价 (元)"}),o(w,{prop:"platformFeeRatio",label:"抽成比例"},{default:a(({row:n})=>[i(c((n.platformFeeRatio*100).toFixed(0))+"% ",1)]),_:1}),o(w,{prop:"sortOrder",label:"排序",width:"80"}),o(w,{label:"操作",width:"180",align:"center"},{default:a(({row:n})=>[o(g,{link:"",type:"primary",icon:"Edit",onClick:$=>T(n)},{default:a(()=>[...e[9]||(e[9]=[i("编辑",-1)])]),_:1},8,["onClick"]),o(z,{title:"确定要删除吗？",onConfirm:$=>I(n)},{reference:a(()=>[o(g,{link:"",type:"danger",icon:"Delete"},{default:a(()=>[...e[10]||(e[10]=[i("删除",-1)])]),_:1})]),_:1},8,["onConfirm"])]),_:1})]),_:1},8,["data"])),[[A,m.value]]),o(J,{modelValue:u.value,"onUpdate:modelValue":e[6]||(e[6]=n=>u.value=n),title:N.value,width:b.value?"90%":"500px",fullscreen:b.value,onClose:P},{footer:a(()=>[r("div",{class:B({"mobile-dialog-footer":b.value})},[o(g,{onClick:e[5]||(e[5]=n=>u.value=!1)},{default:a(()=>[...e[17]||(e[17]=[i("取消",-1)])]),_:1}),o(g,{type:"primary",onClick:U},{default:a(()=>[...e[18]||(e[18]=[i("确定",-1)])]),_:1})],2)]),default:a(()=>[o(Z,{ref_key:"formRef",ref:s,model:l,rules:V,"label-width":"100px","label-position":"top"},{default:a(()=>[o(k,{label:"类目名称",prop:"catName"},{default:a(()=>[o(q,{modelValue:l.catName,"onUpdate:modelValue":e[0]||(e[0]=n=>l.catName=n),placeholder:"请输入类目名称"},null,8,["modelValue"])]),_:1}),o(k,{label:"起步价 (元)",prop:"minPrice"},{default:a(()=>[o(x,{modelValue:l.minPrice,"onUpdate:modelValue":e[1]||(e[1]=n=>l.minPrice=n),min:0,precision:2,"controls-position":"right",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),o(k,{label:"抽成比例",prop:"platformFeeRatio"},{default:a(()=>[o(x,{modelValue:l.platformFeeRatio,"onUpdate:modelValue":e[2]||(e[2]=n=>l.platformFeeRatio=n),min:0,max:1,step:.01,precision:2,"controls-position":"right",style:{width:"100%"}},null,8,["modelValue"]),e[16]||(e[16]=r("span",{class:"text-gray tip"}," (例如: 0.1 表示 10%)",-1))]),_:1}),o(k,{label:"排序",prop:"sortOrder"},{default:a(()=>[o(x,{modelValue:l.sortOrder,"onUpdate:modelValue":e[3]||(e[3]=n=>l.sortOrder=n),min:0,"controls-position":"right",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),o(k,{label:"图标URL",prop:"catIconUrl"},{default:a(()=>[o(q,{modelValue:l.catIconUrl,"onUpdate:modelValue":e[4]||(e[4]=n=>l.catIconUrl=n),placeholder:"请输入图标的URL地址"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title","width","fullscreen"])]),_:1})}}},Rt=X(Qe,[["__scopeId","data-v-406a30db"]]);export{Rt as default};
