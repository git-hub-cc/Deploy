import{_ as T}from"./_plugin-vue_export-helper-DRcqrMy4.js";import{v as j}from"./el-loading-CZvZ1YE_.js";import{E as A}from"./el-card-Dguapzm2.js";import{E as L}from"./el-empty-DZ3VuUlJ.js";import{E as V,a as M}from"./el-table-column-DqRgEsS6.js";import"./el-checkbox-pWPRGKSY.js";import"./el-tooltip-l0sNRNKZ.js";import"./el-popper-CPlk0iR1.js";import"./el-scrollbar-BAAyYTJs.js";/* empty css               */import{E as N}from"./el-image-viewer-CaQ1nI1O.js";/* empty css                  */import{b as $,c as D}from"./admin-gqFvFKRd.js";import{r as h,p as W,q as O,s as q,e as d,h as o,w as a,f as u,U as C,j as F,o as s,O as l,k as r,t as y,g as v,V as K,W as P,x as B,l as G}from"./index-Dczg_W-s.js";import{E as H}from"./index-CsPiBT-M.js";import"./_baseClone-DlauArLD.js";import"./omit-CXgNd_Yj.js";import"./_baseIteratee-YKiEvp97.js";import"./castArray-Bkbd9iUu.js";import"./debounce-D6x4jhS0.js";import"./toNumber-BxgSLSKp.js";import"./raf-BqDiCstf.js";import"./index-D5yFMpEK.js";const J={class:"audit-page"},Q={class:"flex-between mb-20"},X={key:1,class:"text-gray"},Y={key:0},Z={key:1,class:"text-gray"},ee={key:1,class:"mobile-card-list"},te={class:"card-header flex-between"},se={class:"user-info"},ae={class:"nickname"},ne={class:"phone text-gray"},oe={class:"card-body"},re={class:"cert-image-wrapper"},le={key:1,class:"empty-image text-gray"},ie={key:0,class:"reject-reason"},de={key:0,class:"card-footer"},ue=768,ce={__name:"UserAudit",setup(pe){const b=h(window.innerWidth),S=W(()=>b.value<ue),_=h([]),m=h(!1);O(()=>{g(),window.addEventListener("resize",w)}),q(()=>{window.removeEventListener("resize",w)});const w=()=>{b.value=window.innerWidth};async function g(){m.value=!0;try{_.value=await $()}finally{m.value=!1}}function f(c,e){var i;e===3?B.prompt("请输入驳回原因","驳回审核",{confirmButtonText:"确定",cancelButtonText:"取消",inputValidator:n=>n?!0:"驳回原因不能为空"}).then(async({value:n})=>{await E(c.userId,e,n)}).catch(()=>{}):B.confirm(`确认要通过用户 [${((i=c.user)==null?void 0:i.nickname)||c.userId}] 的资质审核吗？`,"通过审核",{type:"success"}).then(async()=>{await E(c.userId,e)}).catch(()=>{})}async function E(c,e,i=null){try{await D({userId:c,status:e,rejectReason:i}),G.success("操作成功"),g()}catch(n){console.error("审核操作失败",n)}}return(c,e)=>{const i=F,n=M,x=N,p=H,U=V,z=L,R=A,I=j;return s(),d("div",J,[o(R,null,{default:a(()=>[u("div",Q,[e[0]||(e[0]=u("h3",null,"响应方资质审核",-1)),o(i,{icon:"Refresh",circle:"",onClick:g,loading:m.value},null,8,["loading"])]),S.value?C((s(),d("div",ee,[_.value.length===0?(s(),l(z,{key:0,description:"暂无审核任务"})):v("",!0),(s(!0),d(K,null,P(_.value,t=>(s(),d("div",{key:t.userId,class:"audit-card"},[u("div",te,[u("div",se,[u("span",ae,y(t.user.nickname),1),u("span",ne,y(t.user.phone),1)]),t.authStatus===1?(s(),l(p,{key:0,type:"warning",size:"small"},{default:a(()=>[...e[7]||(e[7]=[r("待审核",-1)])]),_:1})):t.authStatus===2?(s(),l(p,{key:1,type:"success",size:"small"},{default:a(()=>[...e[8]||(e[8]=[r("已通过",-1)])]),_:1})):t.authStatus===3?(s(),l(p,{key:2,type:"danger",size:"small"},{default:a(()=>[...e[9]||(e[9]=[r("已驳回",-1)])]),_:1})):v("",!0)]),u("div",oe,[u("div",re,[t.certImageUrl?(s(),l(x,{key:0,src:t.certImageUrl,"preview-src-list":[t.certImageUrl],fit:"cover","preview-teleported":""},null,8,["src","preview-src-list"])):(s(),d("div",le,"未上传资质图片"))]),t.authStatus===3?(s(),d("div",ie,[e[10]||(e[10]=u("strong",null,"驳回原因:",-1)),r(" "+y(t.rejectReason),1)])):v("",!0)]),t.authStatus===1?(s(),d("div",de,[o(i,{type:"danger",onClick:k=>f(t,3)},{default:a(()=>[...e[11]||(e[11]=[r("驳回",-1)])]),_:1},8,["onClick"]),o(i,{type:"success",onClick:k=>f(t,2)},{default:a(()=>[...e[12]||(e[12]=[r("通过",-1)])]),_:1},8,["onClick"])])):v("",!0)]))),128))])),[[I,m.value]]):C((s(),l(U,{key:0,data:_.value,border:"",stripe:""},{default:a(()=>[o(n,{prop:"userId",label:"用户ID",width:"100"}),o(n,{prop:"user.nickname",label:"昵称"}),o(n,{prop:"user.phone",label:"手机号"}),o(n,{label:"资质图片",width:"120",align:"center"},{default:a(({row:t})=>[t.certImageUrl?(s(),l(x,{key:0,style:{width:"80px",height:"80px","border-radius":"4px"},src:t.certImageUrl,"preview-src-list":[t.certImageUrl],"preview-teleported":"",fit:"cover"},null,8,["src","preview-src-list"])):(s(),d("span",X,"未上传"))]),_:1}),o(n,{label:"状态",width:"120",align:"center"},{default:a(({row:t})=>[t.authStatus===1?(s(),l(p,{key:0,type:"warning"},{default:a(()=>[...e[1]||(e[1]=[r("待审核",-1)])]),_:1})):t.authStatus===2?(s(),l(p,{key:1,type:"success"},{default:a(()=>[...e[2]||(e[2]=[r("已通过",-1)])]),_:1})):t.authStatus===3?(s(),l(p,{key:2,type:"danger"},{default:a(()=>[...e[3]||(e[3]=[r("已驳回",-1)])]),_:1})):(s(),l(p,{key:3,type:"info"},{default:a(()=>[...e[4]||(e[4]=[r("未提交",-1)])]),_:1}))]),_:1}),o(n,{label:"驳回原因",prop:"rejectReason"},{default:a(({row:t})=>[r(y(t.rejectReason||"-"),1)]),_:1}),o(n,{label:"操作",width:"180",align:"center"},{default:a(({row:t})=>[t.authStatus===1?(s(),d("div",Y,[o(i,{type:"success",size:"small",onClick:k=>f(t,2)},{default:a(()=>[...e[5]||(e[5]=[r("通过",-1)])]),_:1},8,["onClick"]),o(i,{type:"danger",size:"small",onClick:k=>f(t,3)},{default:a(()=>[...e[6]||(e[6]=[r("驳回",-1)])]),_:1},8,["onClick"])])):(s(),d("span",Z,"无需操作"))]),_:1})]),_:1},8,["data"])),[[I,m.value]])]),_:1})])}}},Ve=T(ce,[["__scopeId","data-v-314b4ddf"]]);export{Ve as default};
