const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./AiGroupSettings-DWwBlZpZ.js","./index-dUS5mm6e.js","./index-5uDYxhLe.css","./AiGroupSettings-ChQ7tXrh.css"])))=>i.map(i=>d[i]);
import{_ as P,D as N,a as z,b as E,c as F,r as k,e as v,l,m as r,h as n,k as C,j as o,g as y,O as h,t as i,p as I,J as R,n as b,F as w,s as S,q as U,M as j,v as L,y as q,Y as J,Z as W}from"./index-dUS5mm6e.js";import{R as Y}from"./ResourcePreview-Coimu1VB.js";const Z={key:0,class:"group-info-section"},H={class:"profile-name"},K={class:"profile-id"},Q={class:"member-count"},X={class:"details-tabs"},ee={key:0,class:"tab-content"},se={class:"member-list"},te={class:"member-info"},ae={class:"member-name"},oe={key:0,class:"owner-badge"},ne={key:0,class:"add-member-section"},le={class:"add-member-controls"},re=["value"],ue=["disabled"],ie={key:2,class:"tab-content"},ce={class:"actions"},de={__name:"GroupInfo",setup(ve){const A=J(()=>W(()=>import("./AiGroupSettings-DWwBlZpZ.js"),__vite__mapDeps([0,1,2,3]),import.meta.url)),m=N(),c=z(),M=E(),p=F(),u=k("members"),d=k(""),a=v(()=>m.groups[M.currentChatId]),_=v(()=>{var t;return((t=a.value)==null?void 0:t.owner)===c.userId}),O=R.chat.maxGroupMembers,G=v(()=>{var t;return(t=a.value)==null?void 0:t.id.replace("group_","")}),g=v(()=>{var t;return _.value&&((t=a.value)==null?void 0:t.members.some(e=>{var s;return(s=c.contacts[e])==null?void 0:s.isAI}))}),x=v(()=>a.value?a.value.members.map(t=>{const e=c.contacts[t]||{id:t,name:`用户 ${t.substring(0,4)}`,type:"contact"},s=c.getContactCombinedStatus(t),f=t===a.value.owner;return{...e,isOwner:f,statusText:t===c.userId?"您":e.isAI?"AI 助手":s.statusText,statusClass:s.statusClass,sortOrder:f?0:s.isConnected?1:e.isAI?2:3}}).sort((t,e)=>t.sortOrder-e.sortOrder||t.name.localeCompare(e.name)):[]),T=v(()=>a.value?Object.values(c.contacts).filter(t=>!a.value.members.includes(t.id)):[]);async function $(){if(!d.value)return;await m.addMemberToGroup(a.value.id,d.value)&&(d.value="")}function D(t,e){p.showConfirmationModal({message:`确定要将 "${e}" 移出群组吗？`,onConfirm:()=>m.removeMemberFromGroup(a.value.id,t)})}function V(){p.showConfirmationModal({message:`确定要退出群组 "${a.value.name}" 吗？`,onConfirm:()=>{p.toggleDetailsPanel(!1),m.leaveGroup(a.value.id)}})}function B(){p.showConfirmationModal({message:`确定要解散群组 "${a.value.name}" 吗？此操作不可逆！`,onConfirm:()=>{p.toggleDetailsPanel(!1),m.dissolveGroup(a.value.id)}})}return(t,e)=>a.value?(n(),l("div",Z,[C(h,{entity:a.value,size:"xl",class:"profile-avatar"},null,8,["entity"]),o("h2",H,i(a.value.name),1),o("p",K,"群组 ID: "+i(G.value),1),o("p",Q,i(a.value.members.length)+" / "+i(I(O))+" 名成员",1),o("div",X,[o("button",{class:b({active:u.value==="members"}),onClick:e[0]||(e[0]=s=>u.value="members")},"成员",2),o("button",{class:b({active:u.value==="media"}),onClick:e[1]||(e[1]=s=>u.value="media")},"媒体",2),g.value?(n(),l("button",{key:0,class:b({active:u.value==="ai"}),onClick:e[2]||(e[2]=s=>u.value="ai")},"AI设置",2)):r("",!0)]),u.value==="members"?(n(),l("div",ee,[o("div",se,[(n(!0),l(w,null,S(x.value,s=>(n(),l("div",{key:s.id,class:"member-item"},[C(h,{entity:s,"is-online":s.statusClass==="online",size:"medium"},null,8,["entity","is-online"]),o("div",te,[o("span",ae,[U(i(s.name)+" ",1),s.isOwner?(n(),l("span",oe,"群主")):r("",!0)]),o("span",{class:b(["member-status",s.statusClass])},i(s.statusText),3)]),_.value&&!s.isOwner?(n(),y(j,{key:0,icon:"✕",title:"移除成员",onClick:f=>D(s.id,s.name)},null,8,["onClick"])):r("",!0)]))),128))]),_.value?(n(),l("div",ne,[e[5]||(e[5]=o("hr",null,null,-1)),e[6]||(e[6]=o("h3",null,"添加成员",-1)),o("div",le,[L(o("select",{"onUpdate:modelValue":e[3]||(e[3]=s=>d.value=s)},[e[4]||(e[4]=o("option",{disabled:"",value:""},"选择联系人...",-1)),(n(!0),l(w,null,S(T.value,s=>(n(),l("option",{key:s.id,value:s.id},i(s.name),9,re))),128))],512),[[q,d.value]]),o("button",{class:"btn-primary",onClick:$,disabled:!d.value},"添加",8,ue)])])):r("",!0)])):r("",!0),u.value==="media"?(n(),y(Y,{key:1,"chat-id":a.value.id},null,8,["chat-id"])):r("",!0),u.value==="ai"&&g.value?(n(),l("div",ie,[C(I(A),{"group-id":a.value.id},null,8,["group-id"])])):r("",!0),o("div",ce,[e[7]||(e[7]=o("hr",null,null,-1)),_.value?r("",!0):(n(),l("button",{key:0,class:"btn-danger",onClick:V},"退出群组")),_.value?(n(),l("button",{key:1,class:"btn-danger",onClick:B},"解散群组")):r("",!0)])])):r("",!0)}},_e=P(de,[["__scopeId","data-v-9bfc02a6"]]);export{_e as default};
