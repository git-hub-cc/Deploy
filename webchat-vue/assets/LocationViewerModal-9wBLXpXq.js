import{_,c as h,I as k,e as d,r as y,H as C,o as g,Q as S,g as V,h as c,i as M,l as p,m as b,p as L,R as x,n as z,j as u,v as E,T}from"./index-dUS5mm6e.js";import{L as a}from"./leaflet-src-B1vOQq_m.js";const A={class:"map-container"},B={__name:"LocationViewerModal",setup(U){const i=h(),r=k(),t=d(()=>i.locationViewerContent),n=y(null);let e=null;const v=d(()=>r.isCallActive&&!r.isFullScreenCallViewVisible),m=a.icon({iconUrl:"icons/marker-icon.svg",shadowUrl:"icons/marker-shadow.svg",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]});function w(){if(n.value&&t.value&&!e){const o=[t.value.latitude,t.value.longitude];e=a.map(n.value).setView(o,16),a.tileLayer("https://{s}.ppmc.club/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}).addTo(e),a.marker(o,{icon:m}).addTo(e),e.invalidateSize()}}function s(){i.hideOverlayModal()}function l(o){o.key==="Escape"&&s()}return C(()=>{setTimeout(w,100),window.addEventListener("keydown",l)}),g(()=>{window.removeEventListener("keydown",l),e&&(e.remove(),e=null)}),(o,D)=>{const f=S("motion-pop");return c(),V(T,{name:"location-viewer-fade"},{default:M(()=>[L(i).activeOverlayModal==="locationViewer"&&t.value?(c(),p("div",{key:0,class:z(["viewer-backdrop",{"widget-active":v.value}]),onClick:x(s,["self"])},[u("button",{class:"close-button",onClick:s,title:"关闭 (Esc)"},"×"),E((c(),p("div",A,[u("div",{id:"location-viewer-map",ref_key:"mapContainerRef",ref:n},null,512)])),[[f]])],2)):b("",!0)]),_:1})}}},R=_(B,[["__scopeId","data-v-05ff2575"]]);export{R as default};
