# ===================================================================
#                      Coturn Server Configuration
#                     (Optimized for ppmc.club)
# ===================================================================

# --- Network Settings ---
# STUN/TURN 监听端口
listening-port=3478

# TURN over TLS (加密) 监听端口
tls-listening-port=5349

# [新增] 明确指定监听服务器的内网IP，避免监听在所有接口上
#listening-ip=10.1.8.7

# [新增] 明确指定用于中继的内网IP
relay-ip=10.1.8.7

# [!!! 关键 !!!] 你的服务器公网IP地址。
# Coturn需要这个地址来告诉客户端应该连接哪个IP进行媒体中继。
external-ip=175.178.216.24

# 媒体中继使用的UDP/TCP端口范围
min-port=50000
max-port=50500


# --- Authentication & Realm ---
# 启用长期凭据认证机制
lt-cred-mech

# [!!! 关键 !!!] 明确设置域为你的主域名
realm=turn.ppmc.club

# 静态用户凭证 (与你的客户端代码保持一致)
user=test:123456


# --- TLS/SSL 加密设置 ---
# 指定从 Nginx 配置中找到的证书路径 (这是容器内的路径)
cert=/etc/coturn/certs/ppmc.club_bundle.crt
pkey=/etc/coturn/certs/ppmc.club.key


# --- Logging & Process Management ---
# [推荐] 将日志输出到标准输出，方便使用 `docker logs coturn` 查看
log-file=stdout
# 开启详细日志，便于调试
verbose

# PID 文件路径 (避免Docker容器内权限问题)
pidfile=/var/tmp/turnserver.pid


# --- Security & Performance ---
no-udp-relay-on-tcp-port

# 启用 mobility 支持，改善移动网络下的连接稳定性
mobility

# CLI 管理密码
cli-password=admin123